!function(){var t={};function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function r(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,r)}}function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r,n,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o=[],a=!0,s=!1;try{for(i=i.call(t);!(a=(r=i.next()).done)&&(o.push(r.value),!e||o.length!==e);a=!0);}catch(t){s=!0,n=t}finally{try{a||null==i.return||i.return()}finally{if(s)throw n}}return o}}(t,e)||r(t,e)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||r(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t=/*#__PURE__*/function(){var t;function e(t){var r=this;(function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")})(this,e),this.size=4,this.score=0,this.status="idle",this.board=t||Array(this.size).fill().map(function(){return Array(r.size).fill(0)}),this.won=!1}return t=[{key:"move",value:function(t){if("playing"!==this.status)return!1;var e=!1;switch(t){case"left":e=this.moveLeft();break;case"right":e=this.moveRight();break;case"up":e=this.moveUp();break;case"down":e=this.moveDown()}return e&&(this.addNewTile(),this.checkGameStatus()),e}},{key:"moveLeft",value:function(){return this.moveHorizontal("left")}},{key:"moveRight",value:function(){return this.moveHorizontal("right")}},{key:"moveUp",value:function(){return this.moveVertical("up")}},{key:"moveDown",value:function(){return this.moveVertical("down")}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){return this.status}},{key:"start",value:function(){this.status="playing",this.isBoardEmpty()&&(this.addNewTile(),this.addNewTile())}},{key:"restart",value:function(){var t=this;this.board=Array(this.size).fill().map(function(){return Array(t.size).fill(0)}),this.score=0,this.status="playing",this.won=!1,this.addNewTile(),this.addNewTile()}},{key:"isBoardEmpty",value:function(){return this.board.every(function(t){return t.every(function(t){return 0===t})})}},{key:"getEmptyCells",value:function(){for(var t=[],e=0;e<this.size;e++)for(var r=0;r<this.size;r++)0===this.board[e][r]&&t.push([e,r]);return t}},{key:"addNewTile",value:function(){var t=this.getEmptyCells();if(t.length){var e=n(t[Math.floor(Math.random()*t.length)],2),r=e[0],i=e[1];this.board[r][i]=.9>Math.random()?2:4}}},{key:"moveHorizontal",value:function(t){for(var e=!1,r=0;r<this.size;r++){var n="left"===t?this.board[r].filter(function(t){return 0!==t}):this.board[r].filter(function(t){return 0!==t}).reverse(),o=this.mergeTiles(n),a="left"===t?i(o).concat(i(Array(this.size-o.length).fill(0))):i(Array(this.size-o.length).fill(0)).concat(i(o.reverse()));JSON.stringify(this.board[r])!==JSON.stringify(a)&&(e=!0),this.board[r]=a}return e}},{key:"moveVertical",value:function(t){for(var e=this,r=function(r){var o=e.board.map(function(t){return t[r]}).filter(function(t){return 0!==t});"down"===t&&o.reverse();var a=e.mergeTiles(o),s="up"===t?i(a).concat(i(Array(e.size-a.length).fill(0))):i(Array(e.size-a.length).fill(0)).concat(i(a.reverse()));JSON.stringify(e.board.map(function(t){return t[r]}))!==JSON.stringify(s)&&(n=!0);for(var l=0;l<e.size;l++)e.board[l][r]=s[l]},n=!1,o=0;o<this.size;o++)r(o);return n}},{key:"mergeTiles",value:function(t){for(var e=[],r=0;r<t.length;r++)if(r<t.length-1&&t[r]===t[r+1]){var n=2*t[r];e.push(n),this.score+=n,2048!==n||this.won||(this.won=!0,this.status="win"),r++}else e.push(t[r]);return e}},{key:"checkGameStatus",value:function(){if(!this.won&&!(this.getEmptyCells().length>0)){for(var t=0;t<this.size;t++)for(var e=0;e<this.size;e++){var r=this.board[t][e],i=[[t-1,e],[t+1,e],[t,e-1],[t,e+1]],o=!0,a=!1,s=void 0;try{for(var l,u=i[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var c=n(l.value,2),f=c[0],h=c[1];if(f>=0&&f<this.size&&h>=0&&h<this.size&&this.board[f][h]===r)return}}catch(t){a=!0,s=t}finally{try{o||null==u.return||u.return()}finally{if(a)throw s}}}this.status="lose"}}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(e.prototype,t),e}(),document.addEventListener("DOMContentLoaded",function(){var e=function(){var t=n.getState();i.querySelectorAll(".field-cell").forEach(function(e,r){var n=t[Math.floor(r/4)][r%4];e.className="field-cell",n>0&&e.classList.add("field-cell--".concat(n)),e.textContent=n||""}),u.textContent=n.getScore()},r=function(){var t=n.getStatus();a.classList.toggle("hidden","idle"!==t),s.classList.toggle("hidden","lose"!==t),l.classList.toggle("hidden","win"!==t),o.classList.toggle("start","idle"===t),o.classList.toggle("restart","idle"!==t),o.textContent="idle"===t?"Start":"Restart"},n=new t,i=document.querySelector(".game-field"),o=document.querySelector(".button"),a=document.querySelector(".message-start"),s=document.querySelector(".message-lose"),l=document.querySelector(".message-win"),u=document.querySelector(".game-score");o.addEventListener("click",function(){"idle"===n.getStatus()?n.start():n.restart(),e(),r()}),document.addEventListener("keydown",function(t){if("playing"===n.getStatus()){var i=!1;switch(t.key){case"ArrowLeft":i=n.move("left");break;case"ArrowRight":i=n.move("right");break;case"ArrowUp":i=n.move("up");break;case"ArrowDown":i=n.move("down")}i&&(e(),r())}})})}();
//# sourceMappingURL=index.d0f3fa38.js.map
